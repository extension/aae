<h2>History for Response #<%= @response.id %> for Question #<%= link_to @question.id, expert_question_path(@question) %>: <%= @response.body %></h2>

<table>
	<tr>
	  <th>Modified</th>
	  <th>Who</th>
	  <th>Items Modified</th>
	  <th>Actions</th>
	</tr>
<% if @response.versions.blank? %>
	 <p>There are currently no revisions to this response.</p>
<% else %>
    <% @response.versions.reverse.each do |version| %>	
	<% user = User.find_by_id(version.whodunnit) %>
	<tr>	
	  <td><%= humane_date(version.created_at) %></td>	
	  <td>
	  <% if user.has_exid? %>
	    <%= link_to expert_user_path(user) do %>
           <%= link_expert_user_avatar(user, :thumb) %> <%= link_to user.public_name, expert_user_path(user) %>
        <% end %>
      <% else %>
           <%= link_to user.public_name, expert_user_submitted_path(user) %>
      <% end %>
	  </td>
	  <td><%= version.changeset.keys.join(', ') %></td>	
	  <td>
	    <%= form_tag(restore_response_revision_expert_question_path(:id => @question.id, :response_id => @response.id, :version_id => version.id)) do %>
            <%= submit_tag "Restore Previous", {:class => 'btn'} %>              
            <%= link_to "Compare to previous", diff_with_previous_response_revision_expert_question_path(:id => @question.id, :response_id => @response.id, :version_id => version.id) %>
        <% end %>
	  </td>	
	</tr>	
	<% end %>
<% end %>
</table>