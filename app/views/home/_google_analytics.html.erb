<%
case Settings.app_location
    when 'production'   then @gaprofile = "UA-155321-50"
    when 'dev'          then @gaprofile = "UA-155321-49"
    when 'localdev'     then @gaprofile = "UA-155321-0"
end
%>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '<%= @gaprofile %>']);
  _gaq.push(['_setDomainName', 'ask.extension.org']);
  _gaq.push(['_setCustomVar', 1, 'Site', '<%= controller.send(:_layout) %>', 3]);

<% if current_user %>  
  _gaq.push(['_setCustomVar', 2, 'Visitor Type', 'eXID', 1]);
<%- end -%>
    
<%- if !flash[:googleanalytics].nil? -%>
  _gaq.push(['_trackPageview', '<%= flash[:googleanalytics] %>']);
<%- else  -%>
  _gaq.push(['_trackPageview']);
<%- end -%>  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>